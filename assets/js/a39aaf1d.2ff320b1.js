"use strict";(globalThis.webpackChunksite=globalThis.webpackChunksite||[]).push([[7227],{4996:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"getting-started/first-steps","title":"First Steps","description":"This walkthrough stays in-memory so you can learn the pipeline without running","source":"@site/docs/getting-started/first-steps.md","sourceDirName":"getting-started","slug":"/getting-started/first-steps","permalink":"/stem/getting-started/first-steps","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/stem/tree/main/.site/docs/docs/getting-started/first-steps.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"First Steps","sidebar_label":"First Steps","sidebar_position":3,"slug":"/getting-started/first-steps"},"sidebar":"docs","previous":{"title":"Quick Start","permalink":"/stem/getting-started/quick-start"},"next":{"title":"Infrastructure","permalink":"/stem/getting-started/developer-environment"}}');var n=t(4848),i=t(8453);const a={title:"First Steps",sidebar_label:"First Steps",sidebar_position:3,slug:"/getting-started/first-steps"},l=void 0,o={},d=[{value:"1. Define a task handler",id:"1-define-a-task-handler",level:2},{value:"2. Bootstrap the in-memory runtime",id:"2-bootstrap-the-in-memory-runtime",level:2},{value:"3. Enqueue from a producer",id:"3-enqueue-from-a-producer",level:2},{value:"4. Fetch task results",id:"4-fetch-task-results",level:2},{value:"Choose a broker and backend",id:"choose-a-broker-and-backend",level:2},{value:"Install",id:"install",level:2},{value:"App setup",id:"app-setup",level:2},{value:"Run a worker",id:"run-a-worker",level:2},{value:"Call a task",id:"call-a-task",level:2},{value:"Keeping results",id:"keeping-results",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Next steps",id:"next-steps",level:2}];function c(e){const s={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.p,{children:"This walkthrough stays in-memory so you can learn the pipeline without running\nexternal services. It defines a task, starts a worker, enqueues a message, then\nverifies the result inside a single Dart process."}),"\n",(0,n.jsx)(s.h2,{id:"1-define-a-task-handler",children:"1. Define a task handler"}),"\n",(0,n.jsx)(s.p,{children:"Create a task handler (StemApp will register it for you):"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-dart",metastring:"file=<rootDir>/../packages/stem/example/docs_snippets/lib/first_steps.dart#first-steps-task",children:"class EmailTask extends TaskHandler<String> {\n  @override\n  String get name => 'email.send';\n\n  @override\n  TaskOptions get options => const TaskOptions(maxRetries: 2);\n\n  @override\n  Future<String> call(TaskContext context, Map<String, Object?> args) async {\n    final to = args['to'] as String? ?? 'anonymous';\n    return 'sent to $to';\n  }\n}\n"})}),"\n",(0,n.jsx)(s.h2,{id:"2-bootstrap-the-in-memory-runtime",children:"2. Bootstrap the in-memory runtime"}),"\n",(0,n.jsxs)(s.p,{children:["Use ",(0,n.jsx)(s.code,{children:"StemApp"})," to create the broker, backend, and worker in memory:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-dart",metastring:"file=<rootDir>/../packages/stem/example/docs_snippets/lib/first_steps.dart#first-steps-bootstrap",children:"  final app = await StemApp.inMemory(\n    tasks: [EmailTask()],\n    workerConfig: const StemWorkerConfig(\n      queue: 'default',\n      consumerName: 'first-steps-worker',\n    ),\n  );\n  await app.start();\n"})}),"\n",(0,n.jsx)(s.h2,{id:"3-enqueue-from-a-producer",children:"3. Enqueue from a producer"}),"\n",(0,n.jsx)(s.p,{children:"Enqueue a task from the same process:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-dart",metastring:"file=<rootDir>/../packages/stem/example/docs_snippets/lib/first_steps.dart#first-steps-enqueue",children:"  final taskId = await app.stem.enqueue(\n    'email.send',\n    args: {'to': 'hello@example.com'},\n  );\n  print('Enqueued $taskId');\n"})}),"\n",(0,n.jsx)(s.h2,{id:"4-fetch-task-results",children:"4. Fetch task results"}),"\n",(0,n.jsx)(s.p,{children:"Result backends store the task state and payload:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-dart",metastring:"file=<rootDir>/../packages/stem/example/docs_snippets/lib/first_steps.dart#first-steps-results",children:"  final result = await app.stem.waitForTask<String>(taskId);\n  print('Task state: ${result?.status.state} value=${result?.value}');\n"})}),"\n",(0,n.jsx)(s.h2,{id:"choose-a-broker-and-backend",children:"Choose a broker and backend"}),"\n",(0,n.jsx)(s.p,{children:"Stem lets you mix brokers and backends. Use this quick guide when selecting\nyour first deployment:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Need"}),(0,n.jsx)(s.th,{children:"Broker"}),(0,n.jsx)(s.th,{children:"Backend"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Lowest latency, simplest ops"}),(0,n.jsx)(s.td,{children:"Redis Streams"}),(0,n.jsx)(s.td,{children:"Redis or Postgres"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"SQL visibility & durability"}),(0,n.jsx)(s.td,{children:"Postgres broker"}),(0,n.jsx)(s.td,{children:"Postgres"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Local dev & tests"}),(0,n.jsx)(s.td,{children:"In-memory"}),(0,n.jsx)(s.td,{children:"In-memory"})]})]})]}),"\n",(0,n.jsx)(s.p,{children:"Decision shortcuts:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Start with ",(0,n.jsx)(s.strong,{children:"Redis"})," unless your org mandates another transport."]}),"\n",(0,n.jsxs)(s.li,{children:["Use ",(0,n.jsx)(s.strong,{children:"Postgres"})," when you want a single durable store or SQL-level visibility."]}),"\n",(0,n.jsxs)(s.li,{children:["Use ",(0,n.jsx)(s.strong,{children:"in-memory"})," only for local tests/demos."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["For more detail, see ",(0,n.jsx)(s.a,{href:"/stem/brokers",children:"Broker Overview"})," and\n",(0,n.jsx)(s.a,{href:"/stem/core-concepts/persistence",children:"Persistence"}),"."]}),"\n",(0,n.jsx)(s.h2,{id:"install",children:"Install"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Install Stem and the CLI as shown in ",(0,n.jsx)(s.a,{href:"/stem/getting-started/quick-start",children:"Quick Start"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Ensure ",(0,n.jsx)(s.code,{children:"stem --version"})," runs in your shell."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"app-setup",children:"App setup"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Register tasks and options via ",(0,n.jsx)(s.code,{children:"StemApp"})," or a shared registry (see\n",(0,n.jsx)(s.a,{href:"/stem/core-concepts/tasks",children:"Tasks & Retries"}),")."]}),"\n",(0,n.jsxs)(s.li,{children:["Wire producers with the same task list/registry (see\n",(0,n.jsx)(s.a,{href:"/stem/core-concepts/producer",children:"Producer API"}),")."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"run-a-worker",children:"Run a worker"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Start a worker against your broker and queues (see\n",(0,n.jsx)(s.a,{href:"/stem/getting-started/developer-environment",children:"Connect to Infrastructure"}),")."]}),"\n",(0,n.jsxs)(s.li,{children:["Use ",(0,n.jsx)(s.a,{href:"/stem/workers/control",children:"Worker Control CLI"})," to confirm it is\nresponding."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"call-a-task",children:"Call a task"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Enqueue from your app or the CLI (see\n",(0,n.jsx)(s.a,{href:"/stem/core-concepts/producer",children:"Producer API"}),")."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"keeping-results",children:"Keeping results"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Configure a result backend for stored task results and groups (see\n",(0,n.jsx)(s.a,{href:"/stem/core-concepts/persistence",children:"Persistence"}),")."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"configuration",children:"Configuration"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Use ",(0,n.jsx)(s.code,{children:"STEM_*"})," environment variables for brokers, routing, scheduling, and\nsigning (see ",(0,n.jsx)(s.a,{href:"/stem/core-concepts/cli-control",children:"CLI & Control"}),")."]}),"\n",(0,n.jsxs)(s.li,{children:["Define routing rules in ",(0,n.jsx)(s.code,{children:"STEM_ROUTING_CONFIG"})," for multi-queue setups (see\n",(0,n.jsx)(s.a,{href:"/stem/core-concepts/routing",children:"Routing"}),")."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Diagnose common errors in\n",(0,n.jsx)(s.a,{href:"/stem/getting-started/troubleshooting",children:"Troubleshooting"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Move to ",(0,n.jsx)(s.a,{href:"/stem/getting-started/developer-environment",children:"Connect to Infrastructure"})," to wire\nrouting, autoscaling, and multi-queue workers."]}),"\n",(0,n.jsxs)(s.li,{children:["Review ",(0,n.jsx)(s.a,{href:"/stem/brokers",children:"Broker Overview"})," for transport tradeoffs."]}),"\n",(0,n.jsxs)(s.li,{children:["Explore ",(0,n.jsx)(s.a,{href:"/stem/core-concepts/persistence",children:"Persistence"})," to store results in\nRedis or Postgres."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>a,x:()=>l});var r=t(6540);const n={},i=r.createContext(n);function a(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);