"use strict";(globalThis.webpackChunksite=globalThis.webpackChunksite||[]).push([[635],{1470:(e,r,n)=>{n.d(r,{A:()=>v});var s=n(6540),i=n(4164),t=n(7559),l=n(3104),a=n(6347),d=n(205),c=n(7485),o=n(1682),h=n(679);function u(e){return s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:r,children:n}=e;return(0,s.useMemo)(()=>{const e=r??function(e){return u(e).map(({props:{value:e,label:r,attributes:n,default:s}})=>({value:e,label:r,attributes:n,default:s}))}(n);return function(e){const r=(0,o.XI)(e,(e,r)=>e.value===r.value);if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[r,n])}function x({value:e,tabValues:r}){return r.some(r=>r.value===e)}function g({queryString:e=!1,groupId:r}){const n=(0,a.W6)(),i=function({queryString:e=!1,groupId:r}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:e,groupId:r});return[(0,c.aZ)(i),(0,s.useCallback)(e=>{if(!i)return;const r=new URLSearchParams(n.location.search);r.set(i,e),n.replace({...n.location,search:r.toString()})},[i,n])]}function m(e){const{defaultValue:r,queryString:n=!1,groupId:i}=e,t=p(e),[l,a]=(0,s.useState)(()=>function({defaultValue:e,tabValues:r}){if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!x({value:e,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${r.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=r.find(e=>e.default)??r[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:r,tabValues:t})),[c,o]=g({queryString:n,groupId:i}),[u,m]=function({groupId:e}){const r=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,i]=(0,h.Dv)(r);return[n,(0,s.useCallback)(e=>{r&&i.set(e)},[r,i])]}({groupId:i}),j=(()=>{const e=c??u;return x({value:e,tabValues:t})?e:null})();(0,d.A)(()=>{j&&a(j)},[j]);return{selectedValue:l,selectValue:(0,s.useCallback)(e=>{if(!x({value:e,tabValues:t}))throw new Error(`Can't select invalid tab value=${e}`);a(e),o(e),m(e)},[o,m,t]),tabValues:t}}var j=n(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=n(4848);function k({className:e,block:r,selectedValue:n,selectValue:s,tabValues:t}){const a=[],{blockElementScrollPositionUntilNextRender:d}=(0,l.a_)(),c=e=>{const r=e.currentTarget,i=a.indexOf(r),l=t[i].value;l!==n&&(d(r),s(l))},o=e=>{let r=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=a.indexOf(e.currentTarget)+1;r=a[n]??a[0];break}case"ArrowLeft":{const n=a.indexOf(e.currentTarget)-1;r=a[n]??a[a.length-1];break}}r?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":r},e),children:t.map(({value:e,label:r,attributes:s})=>(0,f.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{a.push(e)},onKeyDown:o,onClick:c,...s,className:(0,i.A)("tabs__item",b.tabItem,s?.className,{"tabs__item--active":n===e}),children:r??e},e))})}function y({lazy:e,children:r,selectedValue:n}){const t=(Array.isArray(r)?r:[r]).filter(Boolean);if(e){const e=t.find(e=>e.props.value===n);return e?(0,s.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:t.map((e,r)=>(0,s.cloneElement)(e,{key:r,hidden:e.props.value!==n}))})}function w(e){const r=m(e);return(0,f.jsxs)("div",{className:(0,i.A)(t.G.tabs.container,"tabs-container",b.tabList),children:[(0,f.jsx)(k,{...r,...e}),(0,f.jsx)(y,{...r,...e})]})}function v(e){const r=(0,j.A)();return(0,f.jsx)(w,{...e,children:u(e.children)},String(r))}},6075:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>d,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"core-concepts/signals","title":"Stem Signals","description":"Stem now exposes Celery-style lifecycle signals so instrumentation can react to","source":"@site/docs/core-concepts/signals.md","sourceDirName":"core-concepts","slug":"/core-concepts/signals","permalink":"/stem/core-concepts/signals","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/stem/tree/main/.site/docs/docs/core-concepts/signals.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Stem Signals","sidebar_label":"Signals","sidebar_position":4,"slug":"/core-concepts/signals"},"sidebar":"docs","previous":{"title":"Routing","permalink":"/stem/core-concepts/routing"},"next":{"title":"Canvas","permalink":"/stem/core-concepts/canvas"}}');var i=n(4848),t=n(8453),l=n(1470),a=n(9365);const d={title:"Stem Signals",sidebar_label:"Signals",sidebar_position:4,slug:"/core-concepts/signals"},c=void 0,o={},h=[{value:"Signal Catalog",id:"signal-catalog",level:2},{value:"Ordering &amp; Semantics",id:"ordering--semantics",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Listening for signals",id:"listening-for-signals",level:2},{value:"Adapters &amp; Middleware",id:"adapters--middleware",level:2},{value:"Example (Docker Compose)",id:"example-docker-compose",level:2},{value:"Retry-Focused Walkthrough",id:"retry-focused-walkthrough",level:3},{value:"Celery Comparison",id:"celery-comparison",level:2},{value:"Performance &amp; Testing",id:"performance--testing",level:2}];function u(e){const r={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.p,{children:["Stem now exposes Celery-style lifecycle signals so instrumentation can react to\npublish, worker, scheduler, and control-plane events without modifying the\nruntime. All payloads live in ",(0,i.jsx)(r.code,{children:"package:stem/src/signals/payloads.dart"})," and map\ndirectly to Stem's task and worker data structures."]}),"\n",(0,i.jsx)(r.h2,{id:"signal-catalog",children:"Signal Catalog"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Category"}),(0,i.jsx)(r.th,{children:"Stem Signal"}),(0,i.jsx)(r.th,{children:"Payload Highlights"}),(0,i.jsx)(r.th,{children:"Celery Equivalent"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Publish"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"beforeTaskPublish"}),", ",(0,i.jsx)(r.code,{children:"afterTaskPublish"})]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"Envelope"}),", attempt metadata, task id"]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"before_task_publish"}),", ",(0,i.jsx)(r.code,{children:"after_task_publish"})]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Worker lifecycle"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"workerInit"}),", ",(0,i.jsx)(r.code,{children:"workerReady"}),", ",(0,i.jsx)(r.code,{children:"workerStopping"}),", ",(0,i.jsx)(r.code,{children:"workerShutdown"}),", ",(0,i.jsx)(r.code,{children:"workerHeartbeat"}),", ",(0,i.jsx)(r.code,{children:"workerChildInit"}),", ",(0,i.jsx)(r.code,{children:"workerChildShutdown"})]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"WorkerInfo"}),", optional reason/timestamps"]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"worker_init"}),", ",(0,i.jsx)(r.code,{children:"worker_ready"}),", ",(0,i.jsx)(r.code,{children:"worker_shutting_down"}),", ",(0,i.jsx)(r.code,{children:"worker_shutdown"}),", ",(0,i.jsx)(r.code,{children:"heartbeat_sent"}),", ",(0,i.jsx)(r.code,{children:"worker_process_init/shutdown"})]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Task lifecycle"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"taskReceived"}),", ",(0,i.jsx)(r.code,{children:"taskPrerun"}),", ",(0,i.jsx)(r.code,{children:"taskPostrun"}),", ",(0,i.jsx)(r.code,{children:"taskRetry"}),", ",(0,i.jsx)(r.code,{children:"taskSucceeded"}),", ",(0,i.jsx)(r.code,{children:"taskFailed"}),", ",(0,i.jsx)(r.code,{children:"taskRevoked"})]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"Envelope"}),", ",(0,i.jsx)(r.code,{children:"WorkerInfo"}),", attempt, result/error context"]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"task_received"}),", ",(0,i.jsx)(r.code,{children:"task_prerun"}),", ",(0,i.jsx)(r.code,{children:"task_postrun"}),", ",(0,i.jsx)(r.code,{children:"task_retry"}),", ",(0,i.jsx)(r.code,{children:"task_success"}),", ",(0,i.jsx)(r.code,{children:"task_failure"}),", ",(0,i.jsx)(r.code,{children:"task_revoked"})]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Scheduler"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"scheduleEntryDue"}),", ",(0,i.jsx)(r.code,{children:"scheduleEntryDispatched"}),", ",(0,i.jsx)(r.code,{children:"scheduleEntryFailed"})]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"ScheduleEntry"}),", tick timestamp, drift, error stack"]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"beat_scheduler_ready"}),", ",(0,i.jsx)(r.code,{children:"beat_schedule"})]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Control plane"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"controlCommandReceived"}),", ",(0,i.jsx)(r.code,{children:"controlCommandCompleted"})]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"ControlCommandMessage"}),", reply status, payload/error maps"]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"control_command_sent"}),", ",(0,i.jsx)(r.code,{children:"control_command_received"})]})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"ordering--semantics",children:"Ordering & Semantics"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"beforeTaskPublish"})," fires immediately before broker IO; ",(0,i.jsx)(r.code,{children:"afterTaskPublish"}),"\nruns once persistence succeeds."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"taskReceived"})," is emitted after middleware but before the task context is\ncreated."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"taskPrerun"})," precedes handler execution; ",(0,i.jsx)(r.code,{children:"taskPostrun"})," runs after completion,\nregardless of outcome. Success and failure signals fire before ",(0,i.jsx)(r.code,{children:"taskPostrun"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:["Worker lifecycle events follow ",(0,i.jsx)(r.code,{children:"workerInit"})," \u2192 ",(0,i.jsx)(r.code,{children:"workerReady"})," \u2192 optional\n",(0,i.jsx)(r.code,{children:"workerStopping"})," \u2192 ",(0,i.jsx)(r.code,{children:"workerShutdown"}),". Heartbeats (",(0,i.jsx)(r.code,{children:"workerHeartbeat"}),") include\nnamespace and queue metadata."]}),"\n",(0,i.jsxs)(r.li,{children:["Scheduler signals fire ",(0,i.jsx)(r.code,{children:"scheduleEntryDue"})," \u2192 dispatch \u2192\n",(0,i.jsx)(r.code,{children:"scheduleEntryDispatched"})," or ",(0,i.jsx)(r.code,{children:"scheduleEntryFailed"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:["Handler exceptions are caught, logged, and surfaced via\n",(0,i.jsx)(r.code,{children:"StemSignals.signalDispatchFailed"})," while the dispatcher continues processing\nremaining listeners unless ",(0,i.jsx)(r.code,{children:"SignalContext.cancel()"})," is invoked."]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["Handlers execute sequentially (respecting registration priority). ",(0,i.jsx)(r.code,{children:"async"}),"\ncallbacks are awaited so ordering remains deterministic."]}),"\n",(0,i.jsx)(r.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsxs)(r.p,{children:["Use ",(0,i.jsx)(r.code,{children:"StemSignals.configure"})," or supply environment variables consumed by\n",(0,i.jsx)(r.code,{children:"ObservabilityConfig.fromEnvironment"}),":"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",metastring:"file=<rootDir>/../packages/stem/example/docs_snippets/lib/signals.dart#signals-configure",children:"void configureSignals() {\n  StemSignals.configure(\n    configuration: const StemSignalConfiguration(\n      enabled: true,\n      enabledSignals: {'worker-heartbeat': false},\n    ),\n  );\n}\n"})}),"\n",(0,i.jsx)(r.p,{children:"Environment knobs:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"STEM_SIGNALS_ENABLED=false"})," disables all signals."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"STEM_SIGNALS_DISABLED=worker-heartbeat,task-prerun"})," disables selected ones."]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["Workers automatically apply the configuration passed through\n",(0,i.jsx)(r.code,{children:"ObservabilityConfig"}),", enabling cluster-wide rollouts without code changes."]}),"\n",(0,i.jsx)(r.h2,{id:"listening-for-signals",children:"Listening for signals"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"publish",label:"Publish",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",metastring:'title="lib/signals.dart" file=<rootDir>/../packages/stem/example/docs_snippets/lib/signals.dart#signals-publish-listeners',children:"List<SignalSubscription> registerPublishSignals() {\n  return [\n    StemSignals.beforeTaskPublish.connect((payload, _) {\n      print('Publishing ${payload.envelope.name}');\n    }),\n    StemSignals.afterTaskPublish.connect((payload, _) {\n      print('Published ${payload.envelope.id}');\n    }),\n  ];\n}\n"})})}),(0,i.jsx)(a.A,{value:"task",label:"Task lifecycle",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",metastring:'title="lib/signals.dart" file=<rootDir>/../packages/stem/example/docs_snippets/lib/signals.dart#signals-task-listeners',children:"List<SignalSubscription> registerTaskSignals() {\n  return [\n    StemSignals.taskRetry.connect((payload, _) {\n      print('Retrying ${payload.envelope.name} at ${payload.nextRetryAt}');\n    }),\n    StemSignals.taskFailed.connect((payload, _) {\n      print('Task failed: ${payload.envelope.id}');\n    }),\n  ];\n}\n"})})}),(0,i.jsx)(a.A,{value:"worker",label:"Worker lifecycle",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",metastring:'title="lib/signals.dart" file=<rootDir>/../packages/stem/example/docs_snippets/lib/signals.dart#signals-worker-listeners',children:"SignalSubscription registerWorkerSignals() {\n  return StemSignals.workerReady.connect((payload, _) {\n    print('Worker ready: ${payload.worker.id}');\n  });\n}\n"})})}),(0,i.jsx)(a.A,{value:"scheduler",label:"Scheduler",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",metastring:'title="lib/signals.dart" file=<rootDir>/../packages/stem/example/docs_snippets/lib/signals.dart#signals-scheduler-listeners',children:"SignalSubscription registerSchedulerSignals() {\n  return StemSignals.scheduleEntryDispatched.connect((payload, _) {\n    print('Schedule dispatched: ${payload.entry.id}');\n  });\n}\n"})})}),(0,i.jsx)(a.A,{value:"control",label:"Control plane",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",metastring:'title="lib/signals.dart" file=<rootDir>/../packages/stem/example/docs_snippets/lib/signals.dart#signals-control-listeners',children:"SignalSubscription registerControlSignals() {\n  return StemSignals.controlCommandCompleted.connect((payload, _) {\n    print('Control command: ${payload.command.type}');\n  });\n}\n"})})})]}),"\n",(0,i.jsx)(r.h2,{id:"adapters--middleware",children:"Adapters & Middleware"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"StemSignalEmitter"})," builds payloads and emits signals; it powers Stem itself\nand is available for custom middleware or broker integrations."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"SignalMiddleware.coordinator()"})," forwards enqueue middleware to publish\nsignals, while ",(0,i.jsx)(r.code,{children:"SignalMiddleware.worker()"})," emits ",(0,i.jsx)(r.code,{children:"taskReceived"}),",\n",(0,i.jsx)(r.code,{children:"taskPrerun"}),", and ",(0,i.jsx)(r.code,{children:"taskFailed"})," from existing worker middleware chains. Success\nand postrun events remain wired through the runtime so result payloads stay\naccurate."]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",metastring:'title="lib/signals.dart" file=<rootDir>/../packages/stem/example/docs_snippets/lib/signals.dart#signals-middleware-producer',children:"List<Middleware> buildSignalMiddlewareForProducer() {\n  return [SignalMiddleware.coordinator()];\n}\n"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",metastring:'title="lib/signals.dart" file=<rootDir>/../packages/stem/example/docs_snippets/lib/signals.dart#signals-middleware-worker',children:"List<Middleware> buildSignalMiddlewareForWorker() {\n  return [\n    SignalMiddleware.worker(\n      workerInfo: () => const WorkerInfo(\n        id: 'signals-worker',\n        queues: ['default'],\n        broadcasts: [],\n      ),\n    ),\n  ];\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"example-docker-compose",children:"Example (Docker Compose)"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"examples/signals_demo"})," spins up a Redis broker, producer, and worker. Running:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"docker compose up --build\n"})}),"\n",(0,i.jsx)(r.p,{children:"streams every signal as structured JSON, showcasing retries, failures, worker\nheartbeats, scheduler drift, and control commands."}),"\n",(0,i.jsx)(r.h3,{id:"retry-focused-walkthrough",children:"Retry-Focused Walkthrough"}),"\n",(0,i.jsxs)(r.p,{children:["For a minimal reproduction of retry cadence, try ",(0,i.jsx)(r.code,{children:"examples/retry_task"}),". The\nworker connects to Redis with ",(0,i.jsx)(r.code,{children:"blockTime=100ms"}),", ",(0,i.jsx)(r.code,{children:"claimInterval=200ms"}),", and\n",(0,i.jsx)(r.code,{children:"defaultVisibilityTimeout=2s"}),", and uses\n",(0,i.jsx)(r.code,{children:"ExponentialJitterRetryStrategy(base: 200ms, max: 1s)"})," so each retry happens in\nunder a second. The producer enqueues a single task with ",(0,i.jsx)(r.code,{children:"maxRetries=2"}),", and the\nconsole prints every ",(0,i.jsx)(r.code,{children:"task_retry"}),", ",(0,i.jsx)(r.code,{children:"task_failed"}),", and ",(0,i.jsx)(r.code,{children:"task_postrun"})," signal.\nExperiment with the strategy or Redis timings to see how they shape retry\nfrequency."]}),"\n",(0,i.jsx)(r.h2,{id:"celery-comparison",children:"Celery Comparison"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Celery"}),(0,i.jsx)(r.th,{children:"Stem"}),(0,i.jsx)(r.th,{children:"Notes"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"task_prerun"})," / ",(0,i.jsx)(r.code,{children:"task_postrun"})]}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"taskPrerun"})," / ",(0,i.jsx)(r.code,{children:"taskPostrun"})]}),(0,i.jsxs)(r.td,{children:["Payload includes the Stem ",(0,i.jsx)(r.code,{children:"TaskContext"})," for heartbeats and lease helpers."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"worker_ready"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"workerReady"})}),(0,i.jsx)(r.td,{children:"Provides queue/broadcast subscriptions for visibility."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"worker_process_init/shutdown"})}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"workerChildInit"})," / ",(0,i.jsx)(r.code,{children:"workerChildShutdown"})]}),(0,i.jsx)(r.td,{children:"Mirrors isolate pool spawn/recycle notifications."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"before_task_publish"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"beforeTaskPublish"})}),(0,i.jsx)(r.td,{children:"Fires before middleware or broker calls."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"beat_schedule"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"scheduleEntryDispatched"})}),(0,i.jsx)(r.td,{children:"Carries scheduled vs executed timestamps plus drift duration."})]})]})]}),"\n",(0,i.jsx)(r.p,{children:"Signals tied to Celery-specific pools remain out of scope; raise a proposal if\nadditional parity is required."}),"\n",(0,i.jsx)(r.h2,{id:"performance--testing",children:"Performance & Testing"}),"\n",(0,i.jsxs)(r.p,{children:["Dispatch short-circuits when disabled, keeping the hot path cheap. Unit tests\nexercise dispatcher priority, handler error handling, worker/scheduler events,\nretry semantics, and the ",(0,i.jsx)(r.code,{children:"SignalMiddleware"})," adapter, ensuring migrations from\nCelery receive the expected hook coverage."]})]})}function p(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>l,x:()=>a});var s=n(6540);const i={},t=s.createContext(i);function l(e){const r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:r},e.children)}},9365:(e,r,n)=>{n.d(r,{A:()=>l});n(6540);var s=n(4164);const i={tabItem:"tabItem_Ymn6"};var t=n(4848);function l({children:e,hidden:r,className:n}){return(0,t.jsx)("div",{role:"tabpanel",className:(0,s.A)(i.tabItem,n),hidden:r,children:e})}}}]);